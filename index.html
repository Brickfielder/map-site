<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cardiac Arrest Survivor Follow-Up Care – UK Services Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    html, body {height:100%; margin:0;}
    #map {width:100%; height:100%;}

    #search-container { position:absolute; top:10px; left:12px; z-index:1000;
      background:rgba(255,255,255,.9); padding:6px 8px; border-radius:6px; box-shadow:0 0 6px rgba(0,0,0,.3); }
    #search-box { width:300px; padding:6px 8px; font-size:14px; }

    /* Popup skin + badges */
    .popup-content { font-family: Arial, sans-serif; font-size:14px; line-height:1.45 }
    .popup-content strong { font-size:16px; }
    .popup-section { margin-bottom:8px; }
    .popup-aud-survivor .leaflet-popup-content-wrapper { background:#ecfdf5; border-left:6px solid #10b981; border-radius:12px; }
    .popup-aud-survivor .leaflet-popup-tip { background:#ecfdf5; }
    .badge { display:inline-block; padding:2px 8px; font-size:11px; font-weight:700; border-radius:9999px; letter-spacing:.2px; margin-left:8px; vertical-align:middle; }
    .badge-audience-survivor  { background:#10b981; color:#052e24; }
  </style>
</head>
<body>
  <div id="map"></div>

  <div id="search-container">
    <input type="text" id="search-box" placeholder="Search services..." list="services-list" />
    <datalist id="services-list"></datalist>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
/* ===================== DATASETS ===================== */
/* HOSPITALS (Survivors & Families audience only) */
const hospitals = [
  {"id":"golden-jubilee-university-hospital","name":"Golden Jubilee University Hospital","lat":55.9035,"lng":-4.4026,"postcode":"G81 4HX","phone":"01389 815000","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated post-cardiac arrest follow-up programme; survivors receive standard cardiac care and rehabilitation as per usual pathways.","longDescription":"This hospital does not run a specific OHCA follow-up clinic. Care after discharge is provided via conventional cardiology and rehabilitation services.","source":"-"},
  {"id":"queen-elizabeth-university-hospital-glasgow","name":"Queen Elizabeth University Hospital","lat":55.8275,"lng":-4.306,"postcode":"G51 4TF","phone":"0141 314 3140","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated post-cardiac arrest follow-up clinic.","longDescription":"Survivors are followed up through standard outpatient cardiology and rehabilitation; there is no bespoke OHCA survivor clinic.","source":"-"},
  {"id":"royal-infirmary-of-edinburgh","name":"Royal Infirmary of Edinburgh","lat":55.9384,"lng":-3.184,"postcode":"EH16 4SA","phone":"0131 536 1000","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Routine post-discharge pathways (cardiology, rehabilitation, primary care) apply; no specific multidisciplinary OHCA aftercare clinic is advertised.","source":"-"},
  {"id":"aberdeen-royal-infirmary","name":"Aberdeen Royal Infirmary","lat":57.1495,"lng":-2.0973,"postcode":"AB25 2ZN","phone":"01224 558888","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Standard cardiology follow-up and general rehabilitation are used; no bespoke programme for cardiac arrest survivors is listed.","source":"-"},
  {"id":"altnagelvin-area-hospital","name":"Altnagelvin Area Hospital","lat":54.985,"lng":-7.295,"postcode":"BT47 6SB","phone":"028 7134 5171","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Survivors are managed via usual care pathways (cardiology and GP follow-up).","source":"-"},
  {"id":"barts-heart-centre","name":"Barts Heart Centre (St Bartholomew’s Hospital)","lat":51.5175,"lng":-0.1001,"postcode":"EC1A 7BE","phone":"020 7377 7000","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No bespoke OHCA survivor clinic is advertised.","longDescription":"Patients receive routine cardiology follow-up; device clinics and cardiac rehabilitation as indicated.","source":"-"},
  {"id":"bristol-heart-institute","name":"Bristol Heart Institute (Bristol Royal Infirmary)","lat":51.459,"lng":-2.5963,"postcode":"BS2 8HW","phone":"0117 923 0000","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Post-arrest survivors are followed in routine services; no specialist OHCA clinic listed.","source":"-"},
  {"id":"derriford-hospital","name":"Derriford Hospital (Plymouth)","lat":50.4162,"lng":-4.1141,"postcode":"PL6 8DH","phone":"01752 202082","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Care continues under standard cardiology and rehabilitation pathways.","source":"-"},
  {"id":"essex-cardiothoracic-centre","name":"Essex Cardiothoracic Centre (Basildon Hospital)","lat":51.5579,"lng":0.4517,"postcode":"SS16 5NL","phone":"01268 524900","eligibility":"Patients admitted with an out-of-hospital cardiac arrest","followUp":"Yes (CARE Clinic)","description":"Dedicated CARE Clinic providing structured follow-up 3–6 months post-discharge for survivors and a relative, led by a specialist ICU nurse.","longDescription":"Operates the UK’s first dedicated Care After REsuscitation (CARE) Clinic, a multidisciplinary follow-up service for cardiac arrest survivors. Approximately 3–6 months post-discharge, survivors (and a family member) return for a holistic assessment with a specialist ICU nurse covering physical recovery, cognitive (memory/thinking) function, and psychological well-being for both survivor and family member. Referrals are made to external services (neuropsychology, rehabilitation, community resources) as needed.","source":"Updated by Dr Marco Mion, CARE Clinic Principal Clinical Psychologist"},
  {"id":"freeman-hospital","name":"Freeman Hospital (Newcastle upon Tyne)","lat":55.002,"lng":-1.594,"postcode":"NE7 7DN","phone":"0191 233 6161","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Routine cardiology and rehabilitation pathways are used; no dedicated OHCA clinic publicly listed.","source":"-"},
  {"id":"glenfield-hospital","name":"Glenfield Hospital (Leicester)","lat":52.65524,"lng":-1.17961,"postcode":"LE3 9QP","phone":"0300 303 1573","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Standard cardiac rehabilitation and outpatient follow-up apply.","source":"-"},
  {"id":"hammersmith-hospital","name":"Hammersmith Hospital (London)","lat":51.517422,"lng":-0.234698,"postcode":"W12 0HS","phone":"020 3311 3311","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Usual NHS outpatient and rehabilitation services provide post-discharge care; no bespoke OHCA clinic listed.","source":"-"},
  {"id":"harefield-hospital","name":"Harefield Hospital (Uxbridge)","lat":51.60711,"lng":-0.4852,"postcode":"UB9 6JH","phone":"01895 823737","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No bespoke OHCA follow-up clinic advertised.","longDescription":"Care through routine cardiology/device and rehab pathways.","source":"-"},
  {"id":"james-cook-university-hospital","name":"James Cook University Hospital (Middlesbrough)","lat":54.552,"lng":-1.214,"postcode":"TS4 3BW","phone":"01642 850850","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Standard post-discharge care pathways apply; no advertised OHCA clinic.","source":"-"},
  {"id":"john-radcliffe-hospital","name":"John Radcliffe Hospital (Oxford)","lat":51.76361,"lng":-1.21861,"postcode":"OX3 9DU","phone":"0300 304 7777","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No bespoke OHCA survivor clinic advertised.","longDescription":"Routine cardiology follow-up and rehabilitation pathways are used.","source":"-"},
  {"id":"morriston-hospital","name":"Morriston Hospital (Swansea)","lat":51.68417,"lng":-3.93472,"postcode":"SA6 6NL","phone":"01792 702222","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Post-discharge care delivered via standard cardiology/rehab pathways.","source":"-"},
  {"id":"northern-general-hospital","name":"Northern General Hospital (Sheffield)","lat":53.41083,"lng":-1.45833,"postcode":"S5 7AU","phone":"0114 243 4343","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Survivors are followed through conventional services; no bespoke clinic listed.","source":"-"},
  {"id":"st-thomas-hospital","name":"St Thomas’ Hospital (London)","lat":51.49796,"lng":-0.11888,"postcode":"SE1 7EH","phone":"020 7188 7188","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Managed through standard cardiology and rehabilitation follow-up.","source":"-"},
  {"id":"kings-college-hospital","name":"King’s College Hospital (London)","lat":51.468078,"lng":-0.09389,"postcode":"SE5 9RS","phone":"020 3299 9000","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Care provided via routine post-discharge pathways (cardiology, neuro-rehab as needed).","source":"-"},
  {"id":"st-georges-hospital","name":"St George’s Hospital (London)","lat":51.426682,"lng":-0.175694,"postcode":"SW17 0QT","phone":"020 8672 1255","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Standard cardiology follow-up and rehabilitation pathways are used.","source":"-"},
  {"id":"royal-free-hospital","name":"Royal Free Hospital (London)","lat":51.553227,"lng":-0.165298,"postcode":"NW3 2QG","phone":"020 7830 2127","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No bespoke OHCA survivor clinic advertised.","longDescription":"Care is through routine outpatient services.","source":"-"},
  {"id":"royal-papworth-hospital","name":"Royal Papworth Hospital (Cambridge)","lat":52.173618,"lng":0.135626,"postcode":"CB2 0AY","phone":"01223 638000","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No formal OHCA follow-up clinic advertised.","longDescription":"Post-arrest follow-up provided through standard pathways (rehab, device clinics, cardiology).","source":"-"},
  {"id":"queen-elizabeth-hospital","name":"Queen Elizabeth Hospital (Birmingham)","lat":52.453198,"lng":-1.938471,"postcode":"B15 2TH","phone":"0121 371 2000","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No bespoke OHCA survivor clinic advertised.","longDescription":"Care follows routine post-discharge pathways.","source":"-"},
  {"id":"manchester-heart-centre","name":"Manchester Heart Centre (Manchester Royal Infirmary)","lat":53.462452,"lng":-2.227709,"postcode":"M13 9WL","phone":"0161 276 1234","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Routine cardiology and rehabilitation services provide aftercare.","source":"-"},
  {"id":"wythenshawe-hospital","name":"Wythenshawe Hospital (Manchester)","lat":53.387938,"lng":-2.293183,"postcode":"M23 9LT","phone":"0161 998 7070","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No bespoke OHCA survivor clinic advertised.","longDescription":"Standard post-discharge pathways apply.","source":"-"},
  {"id":"liverpool-heart-and-chest-hospital","name":"Liverpool Heart and Chest Hospital","lat":53.411167,"lng":-2.897989,"postcode":"L14 3PE","phone":"0151 600 1953","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Care via routine cardiology follow-up and rehabilitation.","source":"-"},
  {"id":"royal-stoke-university-hospital","name":"Royal Stoke University Hospital (Stoke-on-Trent)","lat":53.003262,"lng":-2.211798,"postcode":"ST4 6QG","phone":"01782 715444","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Patients are followed through standard services; no advertised OHCA clinic.","source":"-"},
  {"id":"leeds-general-infirmary","name":"Leeds General Infirmary (Leeds)","lat":53.801461,"lng":-1.551748,"postcode":"LS1 3EX","phone":"0113 243 2799","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No bespoke OHCA survivor clinic advertised.","longDescription":"Care via routine outpatient and rehabilitation pathways.","source":"-"},
  {"id":"royal-sussex-county-hospital","name":"Royal Sussex County Hospital (Brighton)","lat":50.819462,"lng":-0.118149,"postcode":"BN2 5BE","phone":"01273 696955","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Standard care pathways are used post-discharge.","source":"-"},
  {"id":"southampton-general-hospital","name":"Southampton General Hospital (Southampton)","lat":50.933011,"lng":-1.435095,"postcode":"SO16 6YD","phone":"023 8077 7222","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Care is via routine cardiology and rehabilitation services.","source":"-"},
  {"id":"university-hospital-of-wales","name":"University Hospital of Wales (Cardiff)","lat":51.507156,"lng":-3.189855,"postcode":"CF14 4XW","phone":"029 2074 7747","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No bespoke OHCA survivor clinic advertised.","longDescription":"Standard post-discharge follow-up applies.","source":"-"},
  {"id":"royal-victoria-hospital","name":"Royal Victoria Hospital (Belfast)","lat":54.594237,"lng":-5.954027,"postcode":"BT12 6BA","phone":"028 9024 0503","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No dedicated OHCA follow-up clinic.","longDescription":"Routine care pathways are used after discharge.","source":"-"},
  {"id":"norfolk-norwich-university-hospital","name":"Norfolk and Norwich University Hospital","lat":52.617,"lng":1.22,"postcode":"NR4 7UY","phone":"01603 286286","eligibility":"Not specified","followUp":"No (no dedicated follow-up service)","description":"No bespoke OHCA survivor clinic advertised.","longDescription":"Post-discharge follow-up is through standard services.","source":"-"},

  {
  "id":"royal-devon-exeter-scars",
  "name":"Royal Devon & Exeter Hospital (Wonford) – SCARS",
  "lat":50.7189,
  "lng":-3.5079,
  "postcode":"EX2 5DW",
  "phone":"07741 177968",
  "email":"rduh.scarseastern@nhs.net",
  "eligibility":"Out-of-hospital cardiac arrest survivors under Royal Devon University Healthcare NHS FT",
  "followUp":"Yes (SCARS – Sudden Cardiac Arrest Recovery Service)",
  "description":"Hospital-based multidisciplinary follow-up clinic for OHCA survivors and families.",
  "longDescription":"Runs the Sudden Cardiac Arrest Recovery Service (SCARS), a hospital-led follow-up pathway for survivors of OHCA and their families. The service provides structured post-discharge contact and appointments to review physical recovery, cognitive function and psychological well-being, with specific attention to memory gaps and emotional processing. A multidisciplinary team (including specialist nurses and psychological support) offers debriefing about the incident, answers questions, and coordinates referrals to appropriate services (neuropsychology, rehabilitation, community resources). Family members are included to support co-survivor needs and to bridge the gap between hospital care and community recovery.",
  "source":"<a href=\"https://www.royaldevon.nhs.uk/services/resuscitation-department/scars-sudden-cardiac-arrest-recovery-support/\" target=\"_blank\" rel=\"noopener\">Official SCARS page – RD&E</a>"
}
];

/* AIR AMBULANCES */
const airAmbulances = [
  {"id":"air-ambulance-northern-ireland","name":"Air Ambulance Northern Ireland","lat":54.488765,"lng":-6.092659,"postcode":"BT27 5RF","followUp":"No (informal only)","eligibility":"Not specified","description":"No dedicated aftercare programme.","longDescription":"No dedicated aftercare programme is offered. The charity provides informal opportunities for former patients to stay in touch (e.g., sharing recovery stories, community events) but does not run a structured follow-up service post-resuscitation.","contact":"Email: info@airambulanceni.org | Tel: 02892622677","sourceLink":"https://airambulanceni.org"},
  {"id":"cornwall-air-ambulance-trust","name":"Cornwall Air Ambulance Trust","lat":50.432492,"lng":-4.984158,"postcode":"TR8 4DY","followUp":"No (informal only)","eligibility":"Not specified","description":"No formal aftercare programme.","longDescription":"No formal aftercare programme in place. Past patients are encouraged to remain in contact and share experiences, but there is no structured survivor support service.","contact":"Email: enquiries@cornwallairambulancetrust.org | Tel: 01637 889926","sourceLink":"https://cornwallairambulancetrust.org"},
  {"id":"devon-air-ambulance-trust","name":"Devon Air Ambulance Trust","lat":50.740825,"lng":-3.481858,"postcode":"EX4 8NS","followUp":"Yes","eligibility":"Not specified","description":"Patient & Family Support service.","longDescription":"Runs a Patient & Family Support service staffed by specialist clinicians. The team provides practical and emotional support after an incident, answers questions about the pre-hospital phase, guides recovery, and connects survivors and families to further resources or services as needed.","contact":"Email: patientsupport@daat.org | Tel: 01392 466 666","sourceLink":"https://www.daat.org"},
  {"id":"dorset-somerset-air-ambulance","name":"Dorset & Somerset Air Ambulance","lat":50.983973,"lng":-3.200976,"postcode":"TA21 9JQ","followUp":"Yes","eligibility":"Not specified","description":"Patient & Family Liaison Nurses.","longDescription":"Provides a Patient and Family Liaison Nurse service. Liaison nurses offer follow-up care to patients and families after an emergency: answering questions about the pre-hospital event, connecting people with support services (including condition-specific charities), and linking survivors with others who had similar experiences (peer support). A multi-clinician team works with local hospitals to smooth the transition into recovery.","contact":"Email: dsaa.support@nhs.net","sourceLink":"https://www.dsairambulance.org.uk"},
  {"id":"east-anglian-air-ambulance","name":"East Anglian Air Ambulance","lat":52.673176,"lng":1.269394,"postcode":"NR6 6EG","followUp":"Yes","eligibility":"Not specified","description":"Aftercare Team for patients, bystanders and families.","longDescription":"The Aftercare Team supports former patients, their families and friends (and bystanders). They offer listening and debrief, help fill memory gaps, provide bereavement support, and signpost to community services for ongoing needs.","contact":"Email: aftercare@eaaa.org.uk | Tel: 01223 403 600","sourceLink":"https://www.eaaa.org.uk"},
  {"id":"essex-herts-air-ambulance","name":"Essex & Herts Air Ambulance","lat":51.907739,"lng":0.682331,"postcode":"CO6 2NS","followUp":"Yes","eligibility":"Not specified","description":"Patient & Family Liaison team.","longDescription":"Dedicated Patient & Family Liaison team (including liaison nurses and paramedics) supports patients and loved ones after an incident. They provide compassionate emotional support, help families understand what happened, and offer guidance and bereavement support.","contact":"Email: reception@ehaat.org | Tel: 0345 241 7690","sourceLink":"https://www.ehaat.org"},
  {"id":"great-north-air-ambulance-service","name":"Great North Air Ambulance Service","lat":54.525374,"lng":-1.380925,"postcode":"TS16 0QB","followUp":"No (no formal programme)","eligibility":"Not specified","description":"No formal aftercare programme.","longDescription":"No structured aftercare programme; patients and families may contact the charity via general channels for information, but there are no dedicated aftercare staff or clinics.","contact":"Email: info@greatnorthairambulance.co.uk | Tel: 01325 487263","sourceLink":"https://www.greatnorthairambulance.co.uk"},
  {"id":"great-western-air-ambulance-charity","name":"Great Western Air Ambulance Charity","lat":51.439988,"lng":-2.62809,"postcode":"BS3 2JH","followUp":"Yes","eligibility":"Not specified","description":"Patient Support service (dedicated nurse).","longDescription":"Provides a Patient Support service led by a dedicated patient liaison nurse. They follow up with patients and families to answer post-incident questions, offer emotional support, and signpost to additional services or counselling.","contact":"Tel: 0303 4444 999","sourceLink":"https://greatwesternairambulance.com"},
  {"id":"hampshire-isle-of-wight-air-ambulance","name":"Hampshire & Isle of Wight Air Ambulance","lat":50.941027,"lng":-1.470438,"postcode":"SO16 0BT","followUp":"Yes","eligibility":"Not specified","description":"Aftercare Team (named contacts).","longDescription":"Has an Aftercare Team providing ongoing support to former patients and families, including follow-up conversations to debrief about the incident, answering questions about care provided, and signposting to relevant local services. Named Aftercare Managers act as personal contacts for recovery support.","contact":"Email: enquiries@hiowaa.org | Tel: 023 8074 3510","sourceLink":"https://www.hiowaa.org"},
  {"id":"kent-surrey-sussex-air-ambulance","name":"Kent, Surrey & Sussex Air Ambulance","lat":51.345221,"lng":0.506497,"postcode":"ME5 9SD","followUp":"Yes","eligibility":"Not specified","description":"Patient & Family Aftercare (launched 2022).","longDescription":"Launched a Patient and Family Aftercare Service in 2022 offering emotional debriefing, coordination with local hospitals, and signposting to other organisations. The service can reconnect survivors with the crew who treated them, acknowledging the therapeutic value of understanding their own rescue.","contact":"Email: hello@aakss.org.uk | Tel: 01634 471 900","sourceLink":"https://www.aakss.org.uk"},
  {"id":"lincs-notts-air-ambulance","name":"Lincs & Notts Air Ambulance","lat":53.171989,"lng":-0.50793,"postcode":"LN4 2GW","followUp":"Yes","eligibility":"Not specified","description":"Aftercare Team with personalised check-ins.","longDescription":"Provides an Aftercare Team that stays in touch with former patients through phone/email check-ins, offering to answer questions about the incident and recovery, and directing patients to support groups or services.","contact":"Email: support@ambucopter.org.uk | Tel: 01522 548469","sourceLink":"https://www.ambucopter.org.uk"},
  {"id":"londons-air-ambulance-charity","name":"London’s Air Ambulance Charity","lat":51.512491,"lng":-0.072883,"postcode":"E1 8AN","followUp":"Yes","eligibility":"Not specified","description":"Patient Liaison Nurses (since 2014).","longDescription":"Patient Liaison Nurses based with Barts Health have provided aftercare since 2014. They contact survivors after the incident to debrief what happened, offer emotional support, and connect survivors and families with resources or counselling.","contact":"Email: PLN@londonsairambulance.org.uk","sourceLink":"https://www.londonsairambulance.org.uk"},
  {"id":"magpas-air-ambulance","name":"Magpas Air Ambulance","lat":52.37736,"lng":-0.248827,"postcode":"PE28 4YF","followUp":"Yes","eligibility":"Not specified","description":"Dedicated Patient Support Hub.","longDescription":"Operates a dedicated Patient Support Hub for survivors and families to contact the aftercare team. Survivors can talk through their case, seek advice, arrange to meet the crew, and access information on further support services.","contact":"Email: info@magpas.org | Tel: 01480 371060","sourceLink":"https://www.magpas.org.uk"},
  {"id":"midlands-air-ambulance-charity","name":"Midlands Air Ambulance Charity","lat":52.64712,"lng":-2.314772,"postcode":"TF11 8UR","followUp":"Yes","eligibility":"Not specified","description":"Patient Liaison & Aftercare Service (2024).","longDescription":"Introduced a Patient Liaison & Aftercare Service in 2024. Patient Liaison Leads provide information about the incident, emotional support and guidance, and connect patients with additional services. Early feedback demonstrates meaningful impact for patients and families.","contact":"Email: patient.liaison@midlandsairambulance.com | Tel: 0800 8 40 20 40","sourceLink":"https://www.midlandsairambulance.com"},
  {"id":"north-west-air-ambulance-charity","name":"North West Air Ambulance Charity","lat":53.489772,"lng":-2.850378,"postcode":"L33 7UY","followUp":"Yes","eligibility":"Not specified","description":"Aftercare Service with MTC collaboration.","longDescription":"Offers a comprehensive Aftercare Service run in collaboration with regional Major Trauma Centres to ensure continuity of care. The team provides guidance, information and practical support to survivors and their relatives.","contact":"Email: enquiries@nwairambulance.org | Tel: 0800 587 4570","sourceLink":"https://www.nwaa.net"},
  {"id":"scotlands-charity-air-ambulance","name":"Scotland’s Charity Air Ambulance","lat":56.435128,"lng":-3.37423,"postcode":"PH2 6PL","followUp":"No (no programme)","eligibility":"Not specified","description":"No dedicated aftercare programme.","longDescription":"Does not currently provide an in-house aftercare programme. Survivors are signposted to NHS services or partner charities for ongoing support.","contact":"Email: getinvolved@scaa.org.uk | Tel: 0300 123 1111","sourceLink":"https://www.scaa.org.uk"},
  {"id":"thames-valley-air-ambulance","name":"Thames Valley Air Ambulance","lat":51.65,"lng":-0.9,"postcode":"HP14 3SX","followUp":"Yes","eligibility":"Not specified","description":"Patient & Family Aftercare (expanded 2022).","longDescription":"Operates a robust Patient and Family Aftercare programme. Provides comprehensive post-incident support including follow-up home visits, emotional debriefs, help understanding the medical event, signposting to resources, and facilitating peer connections between survivors.","contact":"Email: aftercare@tvairambulance.org.uk | Tel: 0300 999 0135","sourceLink":"https://www.tvairambulance.org.uk"},
  {"id":"air-ambulance-service","name":"The Air Ambulance Service (WNAA & DLRAA)","lat":52.371,"lng":-1.267,"postcode":"CV21 3RQ","followUp":"Yes","eligibility":"Not specified","description":"Clinical Liaison Officer aftercare (Justine Alexander).","longDescription":"Provides a Patient and Family Aftercare service led by a dedicated Clinical Liaison Officer (Justine Alexander). After the incident, this officer reaches out to patients and families, acting as a consistent point of contact to bridge the gap between on-scene care and recovery. She offers support, advice and answers any questions about the care or treatment received, ensuring patients and their loved ones don’t feel abandoned after hospital handover. This service covers the Warwickshire & Northamptonshire and Derbyshire, Leicestershire & Rutland Air Ambulances under TAAS.","contact":"Email: aftercare@theairambulanceservice.org.uk | Tel: 0300 3045 999","sourceLink":"https://theairambulanceservice.org.uk"},
  {"id":"wales-air-ambulance","name":"Wales Air Ambulance Charity","lat":51.684,"lng":-4.132,"postcode":"SA14 8LQ","followUp":"Yes","eligibility":"Not specified","description":"Patient Liaison Nurses provide comprehensive support.","longDescription":"Runs a comprehensive aftercare programme led by Patient Liaison Nurses (e.g., Jo Yeoman and Hayley Whitehead). Offers practical and emotional support following a cardiac arrest or critical incident, assists with paperwork and access to rehabilitation, and connects survivors to community services.","contact":"Email: emrts.patient@wales.nhs.uk | Tel: 0300 300 0067","sourceLink":"https://www.walesairambulance.com"},
  {"id":"wiltshire-air-ambulance","name":"Wiltshire Air Ambulance","lat":51.333,"lng":-2.161,"postcode":"BA14 6JX","followUp":"Yes","eligibility":"Not specified","description":"Aftercare Support Team.","longDescription":"Provides an Aftercare Support Team that follows up with former patients to answer questions about treatment, help them understand what happened, and signpost them to appropriate local or national resources.","contact":"Tel: 01225 300536","sourceLink":"https://www.wiltshireairambulance.co.uk"},
  {"id":"yorkshire-air-ambulance","name":"Yorkshire Air Ambulance","lat":53.694,"lng":-1.832,"postcode":"HX5 0HQ","followUp":"Yes","eligibility":"Not specified","description":"Patient & Family Support initiative.","longDescription":"Runs a Patient and Family Support initiative that offers dedicated support including home visits, helping survivors piece together memories of the event, and connecting them with the crew who treated them. Patient liaison personnel work closely with survivors and relatives.","contact":"Email: patientcare@yaa.org.uk | Tel: 01422 237900","sourceLink":"https://www.yorkshireairambulance.org.uk"}
];

/* CHARITIES & SUPPORT */
const charities = [
  {"id":"save-a-life-for-scotland","name":"Save a Life for Scotland (SALFS)","lat":55.9209289,"lng":-3.1394165,"description":"National partnership to improve OHCA outcomes through CPR training and resources.","longDescription":"A partnership programme that trains people across Scotland in CPR and provides resources for survivors and bystanders. Brings together charities and emergency services to improve OHCA outcomes, and helps link survivors with support via partners.","contact":"Email: hello@savealife.scot","sourceLink":"https://www.savealife.scot"},
  {"id":"chest-heart-stroke-scotland","name":"Chest Heart & Stroke Scotland (CHSS)","lat":55.9539613,"lng":-3.1978848,"description":"Advice Line and support services relevant to cardiac arrest recovery.","longDescription":"Provides a free, confidential Advice Line staffed by health professionals who offer information and emotional support for people affected by chest, heart and stroke conditions (including cardiac arrest survivors) and their families; can guide recovery and rehabilitation after discharge.","contact":"Email: adviceline@chss.org.uk | Tel: 0808 801 0899","sourceLink":"https://www.chss.org.uk"},
  {"id":"scottish-ambulance-ohca-aftercare","name":"Scottish Ambulance Service – OHCA After-care (SALFS partnership)","lat":55.9300758,"lng":-3.2992542,"description":"SAS after-care project via SALFS partnership.","longDescription":"Through the Save a Life for Scotland partnership, SAS runs an OHCA after-care project that supports survivor/bystander CPR training and provides follow-up links for survivors and families by signposting to partner organisations such as CHSS.","contact":"See CHSS Advice Line; SAS site","sourceLink":"https://www.scottishambulance.com"},
  {"id":"save-a-life-cymru","name":"Save a Life Cymru","lat":51.53455,"lng":-3.26105,"description":"CPR awareness initiative (not an aftercare service).","longDescription":"Welsh national initiative focused on CPR awareness and public defibrillation access; does not provide a dedicated survivor aftercare service.","contact":"Email: SaveALifeCymru@wales.nhs.uk","sourceLink":"https://gov.wales/save-a-life-cymru"},
  {"id":"welsh-ambulance-services-restartaheart","name":"Welsh Ambulance Services NHS Trust – Restart-a-Heart","lat":53.25237,"lng":-3.47857,"description":"CPR training; provides survivor resources/signposting.","longDescription":"Delivers the Restart-a-Heart campaign to teach CPR and promote bystander defibrillation. Also provides resources and signposting for cardiac arrest survivors and families through the ambulance service’s community team.","contact":"Email: amb_charity@wales.nhs.uk | Tel: 01745 532900","sourceLink":"https://www.ambulance.wales.nhs.uk"},
  {"id":"british-heart-foundation","name":"British Heart Foundation – Heart Helpline","lat":51.53344,"lng":-0.13962,"description":"Nurse-staffed helpline for recovery guidance.","longDescription":"The Heart Helpline connects callers with experienced cardiac nurses who can advise on heart disease and recovery after cardiac arrest, medication, lifestyle changes, and what to expect post-event.","contact":"Email: hearthelpline@bhf.org.uk | Tel: 0808 802 1234","sourceLink":"https://www.bhf.org.uk"},
  {"id":"bacpr","name":"British Association for Cardiovascular Prevention and Rehabilitation (BACPR)","lat":51.5235694,"lng":-0.1396953,"description":"Professional body supporting cardiac rehab services.","longDescription":"Provides education, professional training, and standards that underpin high-quality cardiac rehabilitation across the UK; not a direct patient-facing aftercare service but supports the services survivors use.","contact":"Email: bacpr@bcs.com | Tel: +44 (0)20 7380 1907","sourceLink":"https://www.bacpr.com"},
  {"id":"sudden-cardiac-arrest-uk","name":"Sudden Cardiac Arrest UK","lat":51.5563655,"lng":0.5507963,"description":"Peer support community for survivors and families.","longDescription":"A peer support group offering forums, survivor stories, resources and events specifically for cardiac arrest survivors and co-survivors.","contact":"Email: info@scauk.org | Tel: 0794 2288111","sourceLink":"https://www.suddencardiacarrestuk.org"},
  {"id":"sads-uk","name":"SADS UK","lat":51.56841,"lng":0.33875,"description":"Support for families affected by sudden arrhythmic death and SCA.","longDescription":"Offers counselling, community defibrillator placement support and education. Can assist survivors and families navigating the emotional aftermath and finding further help.","contact":"Email: sadsoffice@sadsuk.org | Tel: 01277 811215","sourceLink":"https://www.sadsuk.org"}
];

/* ===================== MAP ===================== */
const map = L.map('map').setView([54.5, -3], 6);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '© OpenStreetMap contributors' }).addTo(map);

/* Icons */
const hospitalIcon = L.divIcon({ html:'<span style="font-size:24px">🏥</span>', className:'', iconSize:[24,24], iconAnchor:[12,12], popupAnchor:[0,-12]});
const helicopterIcon = L.divIcon({ html:'<span style="font-size:24px">🚁</span>', className:'', iconSize:[24,24], iconAnchor:[12,12], popupAnchor:[0,-12]});
const charityIcon   = L.divIcon({ html:'<span style="font-size:24px">💗</span>', className:'', iconSize:[24,24], iconAnchor:[12,12], popupAnchor:[0,-12]});

/* Simple audience badge only */
function audienceBadge(){
  return '<span class="badge badge-audience-survivor">Survivors & Families</span>';
}
function popupClassForAudience(){ return 'popup-aud-survivor'; }

/* Add markers directly to the map (no status layers) */
const allMarkers = [];

function hospitalPopup(h){
  const contact = h.phone ? `<div class="popup-section"><em>Contact:</em> Tel: <a href="tel:${(h.phone+'').replace(/\s+/g,'')}">${h.phone}</a></div>` : '';
  const src = h.source ? h.source : '-';
  return `<div class="popup-content">
    <div class="popup-section"><strong>${h.name}</strong> ${audienceBadge()}</div>
    <div class="popup-section"><em>Follow-up care service offered:</em> ${h.followUp || 'Not specified'}</div>
    <div class="popup-section"><em>Eligibility:</em> ${h.eligibility || 'Not specified'}</div>
    <div class="popup-section"><em>Description:</em> ${h.description || ''}</div>
    <div class="popup-section"><em>Details:</em> ${h.longDescription || ''}</div>
    ${contact}
    <div class="popup-section"><em>Source:</em> ${src}</div>
    <div class="popup-section"><em>Date last checked:</em> August 27, 2025</div>
  </div>`;
}

function airAmbulancePopup(svc){
  return `<div class="popup-content">
    <div class="popup-section"><strong>${svc.name}</strong> ${audienceBadge()}</div>
    <div class="popup-section"><em>Follow-up care service offered:</em> ${svc.followUp}</div>
    <div class="popup-section"><em>Eligibility:</em> ${svc.eligibility || 'Not specified'}</div>
    <div class="popup-section"><em>Description:</em> ${svc.description}</div>
    <div class="popup-section"><em>Details:</em> ${svc.longDescription || ''}</div>
    <div class="popup-section"><em>Contact:</em> ${svc.contact || ''}</div>
    <div class="popup-section"><em>Source:</em> ${svc.sourceLink ? `<a href="${svc.sourceLink}" target="_blank" rel="noopener">${svc.sourceLink}</a>` : '-'}</div>
    <div class="popup-section"><em>Date last checked:</em> August 27, 2025</div>
  </div>`;
}

function charityPopup(org){
  return `<div class="popup-content">
    <div class="popup-section"><strong>${org.name}</strong> ${audienceBadge()}</div>
    <div class="popup-section"><em>Description:</em> ${org.description}</div>
    <div class="popup-section"><em>Details:</em> ${org.longDescription || ''}</div>
    <div class="popup-section"><em>Contact:</em> ${org.contact || ''}</div>
    <div class="popup-section"><em>Source:</em> ${org.sourceLink ? `<a href="${org.sourceLink}" target="_blank" rel="noopener">${org.sourceLink}</a>` : '-'}</div>
    <div class="popup-section"><em>Date last checked:</em> August 27, 2025</div>
  </div>`;
}

/* Hospitals */
hospitals.forEach(h=>{
  const m = L.marker([h.lat,h.lng], {icon:hospitalIcon, title:h.name}).addTo(map);
  m.bindPopup(hospitalPopup(h),{className:popupClassForAudience()});
  allMarkers.push({name:h.name,marker:m});
});

/* Air Ambulances */
airAmbulances.forEach(svc=>{
  const m=L.marker([svc.lat,svc.lng],{icon:helicopterIcon,title:svc.name}).addTo(map);
  m.bindPopup(airAmbulancePopup(svc),{className:popupClassForAudience()});
  allMarkers.push({name:svc.name,marker:m});
});

/* Charities */
charities.forEach(org=>{
  const m=L.marker([org.lat,org.lng],{icon:charityIcon,title:org.name}).addTo(map);
  m.bindPopup(charityPopup(org),{className:popupClassForAudience()});
  allMarkers.push({name:org.name,marker:m});
});

/* Search */
const servicesList=document.getElementById('services-list');
allMarkers.forEach(it=>{ const o=document.createElement('option'); o.value=it.name; servicesList.appendChild(o); });
const searchBox=document.getElementById('search-box');
function doSearch(){
  const q=searchBox.value.trim().toLowerCase(); if(!q) return;
  const m=allMarkers.find(it=>it.name.toLowerCase().includes(q));
  if(m){ const ll=m.marker.getLatLng(); map.setView(ll,11); m.marker.openPopup(); }
}
searchBox.addEventListener('change',doSearch);
searchBox.addEventListener('keyup',e=>{ if(e.key==='Enter') doSearch(); });
  </script>
</body>
</html>
